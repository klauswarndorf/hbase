<?xml version="1.0" encoding="UTF-8"?>
<!-- Configures the Camel Context -->

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camel="http://camel.apache.org/schema/spring"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <bean id="viewdata" class="com.yoc.mte.hbase.viewAdTechImpl" />

    <camel:camelContext xmlns="http://camel.apache.org/schema/spring">
        <camel:route id="importFromWebdav">

            <camel:from uri="timer:test?repeatCount=1" />
            <camel:to
                uri="http4://sgsdata.adtech.de/yoc/yoc_ekv_20130718.csv?authUsername=yoc&amp;authPassword=Ticani-X75" />
            <camel:split streaming="true">
                <camel:tokenize token="\n" />
                <camel:choice>
                    <camel:when>
                        <camel:simple>${property.CamelSplitIndex} > 0</camel:simple>
                        <camel:unmarshal ref="bindyDataformat" />
                        <to uri="bean:viewdata" />
                        <setHeader headerName="CamelHBaseFamily">
                            <constant>viewdata</constant>
                        </setHeader>
                        <setHeader headerName="CamelHBaseQualifier">
                            <constant>sequenceid</constant>
                        </setHeader>
                        <setHeader headerName="CamelHBaseValue">
                            <el>${in.body.sequenceid}</el>
                        </setHeader>
                        <setHeader headerName="CamelHBaseQualifier2">
                            <constant>plcnetworkid</constant>
                        </setHeader>
                        <setHeader headerName="CamelHBaseFamily2">
                            <constant>viewdata</constant>
                        </setHeader>
                        <setHeader headerName="CamelHBaseValue2">
                            <el>${in.body.plcNetworkId}</el>
                        </setHeader>
                        <to uri="hbase:test?operation=CamelHBasePut" />
                        <to uri="log:${body}" />
                    </camel:when>
                </camel:choice>
            </camel:split>
        </camel:route>
    </camel:camelContext>

</beans>
